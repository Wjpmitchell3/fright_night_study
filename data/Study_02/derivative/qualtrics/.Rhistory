}
Cols.Response <- NA
for (i in 1:length(Qs)){
Cols.Response <- c(Cols.Response, paste0(Qs[i], ColTypes))
}
Cols.Response <- Cols.Response[-1]
RAT.Cols <- c(Cols.Example, Cols.Response)
colnames(df_rat) <- RAT.Cols
df_rat <- df_rat[, -c(grep("Example.", colnames(df_rat)),grep("ISI.", colnames(df_rat)))]
df_rat <- pivot_longer(data = df_rat,
cols = grep("\\_", colnames(df_rat)),
names_to = c("Question", ".value"),
names_sep = "\\_",
values_drop_na = TRUE)
Answers <- c("boat", "honey", "pin", "blue", "soap", "fast",
"copy", "saw", "top", "pack", "under", "sweet",
"suit", "battle", "power", "watch", "bill", "sugar",
"bank", "space", "bowl", "ball", "gas", "dog","air",
"check", "post", "steam", "jelly", "broad", "sore",
"chair", "day", "pot", "blind", "candle", "cart",
"camp", "station", "mark", "gate", "field", "tow",
"salad", "lip")
df_rat$Answer <- NA
for (i in 1:length(rownames(df_rat))){
for (j in 1:length(Qs)){
if (df_rat$Question[i] == Qs[j])
df_rat$Answer[i] <- Answers[j]
}
}
df_rat$Correct <- NA
df_rat$Response[is.na(df_rat$Response)] <- "NO ANSWER"
for (i in 1:length(rownames(df_rat))){
if (is.na(df_rat$Response[i]))
df_rat$Correct[i] <- 0
if (tolower(df_rat$Response[i]) != tolower(df_rat$Answer[i]))
df_rat$Correct[i] <- 0
if (tolower(df_rat$Response[i]) == tolower(df_rat$Answer[i]))
df_rat$Correct[i] <- 1
}
Rows <- 1:length(sort(rep(unique(df_rat$PID), 3)))
Cols <- c("PID", "Stage", "Correct", "AvgTime")
df_rat_pl  <- data.frame(matrix(NA,
nrow = length(Rows),
ncol = length(Cols),
dimnames = list(Rows, Cols)))
df_rat_pl$PID <- sort(rep(unique(df_rat$PID), 3))
df_rat_pl$Stage <- rep(unique(df_rat$Stage), length(unique(df_rat_pl$PID)))
for (i in unique(df_rat_pl$Stage)){
for (j in unique(df_rat_pl$PID)){
df_rat_pl$Correct[df_rat_pl$Stage == i & df_rat_pl$PID == j] <- sum(as.numeric(df_rat$Correct[df_rat$Stage == i & df_rat$PID == j]))
df_rat_pl$AvgTime[df_rat_pl$Stage == i & df_rat_pl$PID == j] <- mean(as.numeric(df_rat$PageSubmit[df_rat$Stage == i & df_rat$PID == j]), na.rm =  T)
}
}
df_rat_pl <- df_rat_pl[-is.na(df_rat_pl$AvgTime),]
for (i in unique(df_rat_pl$PID)){
df_rat_pl$Practice[df_rat_pl$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure"]
}
m1 <- lmer(Correct ~  Stage + (1|PID), data = df_rat_pl)
stargazer(m1, type = "text")
m1 <- lmer(AvgTime ~  Stage + (1|PID), data = df_rat_pl)
stargazer(m1, type = "text")
plot(m1)
m1 <- lmer(AvgTime ~  Stage + (1|PID), data = df_rat_pl)
stargazer(m1, type = "text")
m1 <- lmer(Correct ~  Stage + (1|PID), data = df_rat_pl)
stargazer(m1, type = "text")
plot(m1)
View(df_rat_pl)
View(df_rat)
aov <- aov(Correct ~ Stage + Error(Participant), data = df_rat_pl)
aov <- aov(Correct ~ Stage + Error(PID), data = df_rat_pl)
summary(aov)
sjstats::anova_stats(aov, digits = 3)
ggplot(df_rat_plot, aes(x = Stage, y = Correct)) +
stat_summary(geom="point", fun = mean, size = 3.5) +
labs(title = "Differences in Correct RAT Responses By Stage",
subtitle = NULL,
x =NULL,
y ="Number Correct",
caption = "p > 0.05: N.S. \np < 0.05: * \np < 0.01: ** \np < 0.001: ***") +
coord_cartesian(ylim=c(0, 12)) +
theme_classic() +
theme(plot.title = element_text(face="bold", size=13, hjust = 0.5)) +
theme(plot.subtitle = element_text(size = 10, hjust = 0.5, face = "italic")) +
theme(plot.caption = element_text(size = 8, hjust = 0.0, face = "italic")) +
theme(axis.title = element_text(size = 12)) +
theme(axis.text.x = element_text(size = 14, color = "Black")) +
theme(axis.text.y = element_text(size = 14, color = "Black"))
ggplot(df_rat_pl, aes(x = Stage, y = Correct)) +
stat_summary(geom="point", fun = mean, size = 3.5) +
labs(title = "Differences in Correct RAT Responses By Stage",
subtitle = NULL,
x =NULL,
y ="Number Correct",
caption = "p > 0.05: N.S. \np < 0.05: * \np < 0.01: ** \np < 0.001: ***") +
coord_cartesian(ylim=c(0, 12)) +
theme_classic() +
theme(plot.title = element_text(face="bold", size=13, hjust = 0.5)) +
theme(plot.subtitle = element_text(size = 10, hjust = 0.5, face = "italic")) +
theme(plot.caption = element_text(size = 8, hjust = 0.0, face = "italic")) +
theme(axis.title = element_text(size = 12)) +
theme(axis.text.x = element_text(size = 14, color = "Black")) +
theme(axis.text.y = element_text(size = 14, color = "Black"))
Plot
ggplot(df_rat_pl, aes(x = Stage, y = Correct)) +
stat_summary(geom="point", fun = mean, size = 3.5) +
labs(title = "Differences in Correct RAT Responses By Stage",
subtitle = NULL,
x =NULL,
y ="Number Correct",
caption = "p > 0.05: N.S. \np < 0.05: * \np < 0.01: ** \np < 0.001: ***") +
coord_cartesian(ylim=c(0, 12)) +
theme_classic() +
theme(plot.title = element_text(face="bold", size=13, hjust = 0.5)) +
theme(plot.subtitle = element_text(size = 10, hjust = 0.5, face = "italic")) +
theme(plot.caption = element_text(size = 8, hjust = 0.0, face = "italic")) +
theme(axis.title = element_text(size = 12)) +
theme(axis.text.x = element_text(size = 14, color = "Black")) +
theme(axis.text.y = element_text(size = 14, color = "Black"))
aov <- aov(AvgTime ~ Stage + Error(PID), data = df_rat_pl)
summary(aov)
sjstats::anova_stats(aov, digits = 3)
ggplot(df_rat_pl, aes(x = Stage, y = AvgTime)) +
stat_summary(geom="point", fun = mean, size = 3.5) +
labs(title = "Differences in Correct RAT Responses By Stage",
subtitle = NULL,
x =NULL,
y ="Number Correct",
caption = "p > 0.05: N.S. \np < 0.05: * \np < 0.01: ** \np < 0.001: ***") +
coord_cartesian(ylim=c(0, 12)) +
theme_classic() +
theme(plot.title = element_text(face="bold", size=13, hjust = 0.5)) +
theme(plot.subtitle = element_text(size = 10, hjust = 0.5, face = "italic")) +
theme(plot.caption = element_text(size = 8, hjust = 0.0, face = "italic")) +
theme(axis.title = element_text(size = 12)) +
theme(axis.text.x = element_text(size = 14, color = "Black")) +
theme(axis.text.y = element_text(size = 14, color = "Black"))
ggplot(df_rat_pl, aes(x = Stage, y = Correct)) +
stat_summary(geom="point", fun = mean, size = 3.5) +
labs(title = "Differences in Correct RAT Responses By Stage",
subtitle = NULL,
x =NULL,
y ="Number Correct",
caption = "p > 0.05: N.S. \np < 0.05: * \np < 0.01: ** \np < 0.001: ***") +
theme_classic() +
theme(plot.title = element_text(face="bold", size=13, hjust = 0.5)) +
theme(plot.subtitle = element_text(size = 10, hjust = 0.5, face = "italic")) +
theme(plot.caption = element_text(size = 8, hjust = 0.0, face = "italic")) +
theme(axis.title = element_text(size = 12)) +
theme(axis.text.x = element_text(size = 14, color = "Black")) +
theme(axis.text.y = element_text(size = 14, color = "Black"))
ggplot(df_rat_pl, aes(x = Stage, y = AvgTime)) +
stat_summary(geom="point", fun = mean, size = 3.5) +
labs(title = "Differences in Correct RAT Responses By Stage",
subtitle = NULL,
x =NULL,
y ="Number Correct",
caption = "p > 0.05: N.S. \np < 0.05: * \np < 0.01: ** \np < 0.001: ***") +
theme_classic() +
theme(plot.title = element_text(face="bold", size=13, hjust = 0.5)) +
theme(plot.subtitle = element_text(size = 10, hjust = 0.5, face = "italic")) +
theme(plot.caption = element_text(size = 8, hjust = 0.0, face = "italic")) +
theme(axis.title = element_text(size = 12)) +
theme(axis.text.x = element_text(size = 14, color = "Black")) +
theme(axis.text.y = element_text(size = 14, color = "Black"))
df_rat_pl$Stage <- relevel(df_rat_pl$Stage, ref = "Pre-Exposure")
df_rat_pl$Stage <- relevel(as.factor(df_rat_pl$Stage), ref = "Pre-Exposure")
levels(df_rat_pl$Stage )
df_rat_pl$Stage <- relevel(as.factor(df_rat_pl$Stage), ref = "Pre-Exposure")
levels(df_rat_pl$Stage )
aov <- aov(Correct ~ Stage + Error(PID), data = df_rat_pl)
summary(aov)
sjstats::anova_stats(aov, digits = 3)
ggplot(df_rat_pl, aes(x = Stage, y = Correct)) +
stat_summary(geom="point", fun = mean, size = 3.5) +
labs(title = "Differences in Correct RAT Responses By Stage",
subtitle = NULL,
x =NULL,
y ="Number Correct",
caption = "p > 0.05: N.S. \np < 0.05: * \np < 0.01: ** \np < 0.001: ***") +
theme_classic() +
theme(plot.title = element_text(face="bold", size=13, hjust = 0.5)) +
theme(plot.subtitle = element_text(size = 10, hjust = 0.5, face = "italic")) +
theme(plot.caption = element_text(size = 8, hjust = 0.0, face = "italic")) +
theme(axis.title = element_text(size = 12)) +
theme(axis.text.x = element_text(size = 14, color = "Black")) +
theme(axis.text.y = element_text(size = 14, color = "Black"))
aov <- aov(AvgTime ~ Stage + Error(PID), data = df_rat_pl)
summary(aov)
sjstats::anova_stats(aov, digits = 3)
ggplot(df_rat_pl, aes(x = Stage, y = AvgTime)) +
stat_summary(geom="point", fun = mean, size = 3.5) +
labs(title = "Differences in Correct RAT Responses By Stage",
subtitle = NULL,
x =NULL,
y ="Number Correct",
caption = "p > 0.05: N.S. \np < 0.05: * \np < 0.01: ** \np < 0.001: ***") +
theme_classic() +
theme(plot.title = element_text(face="bold", size=13, hjust = 0.5)) +
theme(plot.subtitle = element_text(size = 10, hjust = 0.5, face = "italic")) +
theme(plot.caption = element_text(size = 8, hjust = 0.0, face = "italic")) +
theme(axis.title = element_text(size = 12)) +
theme(axis.text.x = element_text(size = 14, color = "Black")) +
theme(axis.text.y = element_text(size = 14, color = "Black"))
df_test <- as.data.frame(sort(unique(df_rat_pl$PID)))
colnames(df_test[1]) <- "PID"
df_test$diff <- NA
View(df_test)
df_test <- as.data.frame(sort(unique(df_rat_pl$PID)))
colnames(df_test) <- "PID"
df_test$diff <- NA
View(df_test)
df_test <- as.data.frame(sort(unique(df_rat_pl$PID)))
colnames(df_test) <- "PID"
df_test$diff <- NA
for (i in unique(df_test$PID)){
df_test$PID[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] -df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure"]
}
df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"]
df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure"]
df_rat_pl$Stage == "Pre-Exposure"
for (i in unique(df_test$PID)){
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure")){
df_test$PID[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure"]
}
}
View(df_test)
df_test <- as.data.frame(sort(unique(df_rat_pl$PID)))
colnames(df_test) <- "PID"
df_test$diff <- NA
for (i in unique(df_test$PID)){
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure")){
df_test$diff[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure"]
}
}
View(df_test)
mean(df_test$diff)
mean(df_test$diff, na.rm = T)
range(df_test$diff, na.rm = T)
sd(df_test$diff, na.rm = T)
df_test$diffbefore <- NA
unique(df_rat_pl$Stage)
df_test <- as.data.frame(sort(unique(df_rat_pl$PID)))
colnames(df_test) <- "PID"
df_test$diffbefore <- NA
df_test$diffafter <- NA
for (i in unique(df_test$PID)){
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure")){
df_test$diffbefore[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure"]
}
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "One Week Post-Exposure")){
df_test$diffbefore[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "One Week Post-Exposure"]
}
}
View(df_test)
df_test <- as.data.frame(sort(unique(df_rat_pl$PID)))
colnames(df_test) <- "PID"
df_test$diffbefore <- NA
df_test$diffafter <- NA
for (i in unique(df_test$PID)){
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure")){
df_test$diffbefore[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure"]
}
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "One Week Post-Exposure")){
df_test$diffafter[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "One Week Post-Exposure"]
}
}
View(df_test)
df_test$congru <- 0
if (df_test$diffbefore > 0 & df_test$diffafter > 0){
df_test$congru <- 1
}
df_test$congru <- 0
if (df_test$diffbefore > 0 & df_test$diffafter > 0 & !is.na(df_test$diffbefore) & !is.na(df_test$diffafter)){
df_test$congru <- 1
}
df_test <- as.data.frame(sort(unique(df_rat_pl$PID)))
colnames(df_test) <- "PID"
df_test$diffbefore <- NA
df_test$diffafter <- NA
for (i in unique(df_test$PID)){
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure")){
df_test$diffbefore[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure"]
}
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "One Week Post-Exposure")){
df_test$diffafter[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "One Week Post-Exposure"]
}
}
df_test$congru <- 0
for (i in 1:nrow(df_test)){
if (df_test$diffbefore[i] > 0 & df_test$diffafter[i] > 0 & !is.na(df_test$diffbefore[i]) & !is.na(df_test$diffafter[i])){
df_test$congru[i] <- 1
}
if (df_test$diffbefore[i] < 0 & df_test$diffafter[i] < 0 & !is.na(df_test$diffbefore[i]) & !is.na(df_test$diffafter[i])){
df_test$congru[i] <- 1
}
}
View(df_test)
table(df_test$congru)
df_test <- as.data.frame(sort(unique(df_rat_pl$PID)))
colnames(df_test) <- "PID"
df_test$diffbefore <- NA
df_test$diffafter <- NA
for (i in unique(df_test$PID)){
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure")){
df_test$diffbefore[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure"]
}
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "One Week Post-Exposure")){
df_test$diffafter[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "One Week Post-Exposure"]
}
}
df_test$congru <- 0
for (i in 1:nrow(df_test)){
if (df_test$diffbefore[i] > 0 & df_test$diffafter[i] > 0 & !is.na(df_test$diffbefore[i]) & !is.na(df_test$diffafter[i])){
df_test$congru[i] <- 1
}
if (df_test$diffbefore[i] < 0 & df_test$diffafter[i] < 0 & !is.na(df_test$diffbefore[i]) & !is.na(df_test$diffafter[i])){
df_test$congru[i] <- 2
}
}
table(df_test$congru)
df_test <- as.data.frame(sort(unique(df_rat_pl$PID)))
colnames(df_test) <- "PID"
df_test$diffbefore <- NA
df_test$diffafter <- NA
for (i in unique(df_test$PID)){
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure")){
df_test$diffbefore[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure"]
}
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "One Week Post-Exposure")){
df_test$diffafter[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "One Week Post-Exposure"]
}
}
df_test$congru <- "Mixed"
for (i in 1:nrow(df_test)){
if (df_test$diffbefore[i] > 0 & df_test$diffafter[i] > 0 & !is.na(df_test$diffbefore[i]) & !is.na(df_test$diffafter[i])){
df_test$congru[i] <- "Higher Imm"
}
if (df_test$diffbefore[i] < 0 & df_test$diffafter[i] < 0 & !is.na(df_test$diffbefore[i]) & !is.na(df_test$diffafter[i])){
df_test$congru[i] <- "Lower Imm"
}
}
table(df_test$congru)
library(lme4)
library(psych)
library(stargazer)
library(tidyverse)
options(scipen=100)
options(digits=3)
options(tinytex.verbose = TRUE)
source("S:/Murty_Group/studies/frightnight.02/scripts/R/Data_Cleaning.R")
df_rat <- df[,c(18:541)]
Cols.Example <- c("PID", "Stage",
"Example.1_FirstClick", "Example.1_LastClick", "Example.1_PageSubmit", "Example.1_ClickCount", "Example.1_Response",
"Example.1_Answer.FirstClick.", "Example.1_Answer.LastClick", "Example.1_Answer.PageSubmit", "Example.1_Answer.ClickCount",
"Example.1_ISI.FirstClick.", "Example.1_ISI.LastClick", "Example.1_ISI.PageSubmit", "Example.1_ISI.ClickCount",
"Example.2_FirstClick", "Example.2_LastClick", "Example.2_PageSubmit", "Example.2_ClickCount", "Example.2_Response",
"Example.2_Answer.FirstClick.", "Example.2_Answer.LastClick", "Example.2_Answer.PageSubmit", "Example.2_Answer.ClickCount",
"Example.2_ISI.FirstClick.", "Example.2_ISI.LastClick", "Example.2_ISI.PageSubmit", "Example.2_ISI.ClickCount",
"Example.3_FirstClick", "Example.3_LastClick", "Example.3_PageSubmit", "Example.3_ClickCount", "Example.3_Response",
"Example.3_Answer.FirstClick.", "Example.3_Answer.LastClick", "Example.3_Answer.PageSubmit", "Example.3_Answer.ClickCount",
"Example.3_ISI.FirstClick.", "Example.3_ISI.LastClick", "Example.3_ISI.PageSubmit", "Example.3_ISI.ClickCount",
"Example.4_FirstClick", "Example.4_LastClick", "Example.4_PageSubmit", "Example.4_ClickCount", "Example.4_Response",
"Example.4_Answer.FirstClick.", "Example.4_Answer.LastClick", "Example.4_Answer.PageSubmit", "Example.4_Answer.ClickCount",
"Example.4_ISI.FirstClick.", "Example.4_ISI.LastClick", "Example.4_ISI.PageSubmit", "Example.4_ISI.ClickCount",
"Example.5_FirstClick", "Example.5_LastClick", "Example.5_PageSubmit", "Example.5_ClickCount", "Example.5_Response",
"Example.5_Answer.FirstClick.", "Example.5_Answer.LastClick", "Example.5_Answer.PageSubmit", "Example.5_Answer.ClickCount",
"Example.5_ISI.FirstClick.", "Example.5_ISI.LastClick", "Example.5_ISI.PageSubmit", "Example.5_ISI.ClickCount",
"Example.6_FirstClick", "Example.6_LastClick", "Example.6_PageSubmit", "Example.6_ClickCount", "Example.6_Response",
"Example.6_Answer.FirstClick.", "Example.6_Answer.LastClick", "Example.6_Answer.PageSubmit", "Example.6_Answer.ClickCount",
"Example.6_ISI.FirstClick.", "Example.6_ISI.LastClick", "Example.6_ISI.PageSubmit", "Example.6_ISI.ClickCount",
"Example.7_FirstClick", "Example.7_LastClick", "Example.7_PageSubmit", "Example.7_ClickCount", "Example.7_Response",
"Example.7_Answer.FirstClick.", "Example.7_Answer.LastClick", "Example.7_Answer.PageSubmit", "Example.7_Answer.ClickCount",
"Example.7_ISI.FirstClick.", "Example.7_ISI.LastClick", "Example.7_ISI.PageSubmit", "Example.7_ISI.ClickCount",
"Example.8_FirstClick", "Example.8_LastClick", "Example.8_PageSubmit", "Example.8_ClickCount", "Example.8_Response",
"Example.8_Answer.FirstClick.", "Example.8_Answer.LastClick", "Example.8_Answer.PageSubmit", "Example.8_Answer.ClickCount",
"Example.8_ISI.FirstClick.", "Example.8_ISI.LastClick", "Example.8_ISI.PageSubmit", "Example.8_ISI.ClickCount",
"Example.9_FirstClick", "Example.9_LastClick", "Example.9_PageSubmit", "Example.9_ClickCount", "Example.9_Response",
"Example.9_Answer.FirstClick.", "Example.9_Answer.LastClick", "Example.9_Answer.PageSubmit", "Example.9_Answer.ClickCount",
"Example.9_ISI.FirstClick.", "Example.9_ISI.LastClick", "Example.9_ISI.PageSubmit", "Example.9_ISI.ClickCount")
ColTypes <- c("_FirstClick", "_LastClick", "_PageSubmit", "_ClickCount", "_Response",
"_ISI.FirstClick.", "_ISI.LastClick", "_ISI.PageSubmit", "_ISI.ClickCount")
Groups <- c("A", "B", "C")
Qs <- NA
for (i in 1:length(Groups)){
Qs <- sort(c(Qs, paste0(Groups[i], "0", 1:9), paste0(Groups[i], 10:15)))
}
Cols.Response <- NA
for (i in 1:length(Qs)){
Cols.Response <- c(Cols.Response, paste0(Qs[i], ColTypes))
}
Cols.Response <- Cols.Response[-1]
RAT.Cols <- c(Cols.Example, Cols.Response)
colnames(df_rat) <- RAT.Cols
df_rat <- df_rat[, -c(grep("Example.", colnames(df_rat)),grep("ISI.", colnames(df_rat)))]
df_rat <- pivot_longer(data = df_rat,
cols = grep("\\_", colnames(df_rat)),
names_to = c("Question", ".value"),
names_sep = "\\_",
values_drop_na = TRUE)
Answers <- c("boat", "honey", "pin", "blue", "soap", "fast",
"copy", "saw", "top", "pack", "under", "sweet",
"suit", "battle", "power", "watch", "bill", "sugar",
"bank", "space", "bowl", "ball", "gas", "dog","air",
"check", "post", "steam", "jelly", "broad", "sore",
"chair", "day", "pot", "blind", "candle", "cart",
"camp", "station", "mark", "gate", "field", "tow",
"salad", "lip")
df_rat$Answer <- NA
for (i in 1:length(rownames(df_rat))){
for (j in 1:length(Qs)){
if (df_rat$Question[i] == Qs[j])
df_rat$Answer[i] <- Answers[j]
}
}
df_rat$Correct <- NA
df_rat$Response[is.na(df_rat$Response)] <- "NO ANSWER"
for (i in 1:length(rownames(df_rat))){
if (is.na(df_rat$Response[i]))
df_rat$Correct[i] <- 0
if (tolower(df_rat$Response[i]) != tolower(df_rat$Answer[i]))
df_rat$Correct[i] <- 0
if (tolower(df_rat$Response[i]) == tolower(df_rat$Answer[i]))
df_rat$Correct[i] <- 1
}
Rows <- 1:length(sort(rep(unique(df_rat$PID), 3)))
Cols <- c("PID", "Stage", "Correct", "AvgTime")
df_rat_pl  <- data.frame(matrix(NA,
nrow = length(Rows),
ncol = length(Cols),
dimnames = list(Rows, Cols)))
df_rat_pl$PID <- sort(rep(unique(df_rat$PID), 3))
df_rat_pl$Stage <- rep(unique(df_rat$Stage), length(unique(df_rat_pl$PID)))
for (i in unique(df_rat_pl$Stage)){
for (j in unique(df_rat_pl$PID)){
df_rat_pl$Correct[df_rat_pl$Stage == i & df_rat_pl$PID == j] <- sum(as.numeric(df_rat$Correct[df_rat$Stage == i & df_rat$PID == j]))
df_rat_pl$AvgTime[df_rat_pl$Stage == i & df_rat_pl$PID == j] <- mean(as.numeric(df_rat$PageSubmit[df_rat$Stage == i & df_rat$PID == j]), na.rm =  T)
}
}
df_rat_pl <- df_rat_pl[-is.na(df_rat_pl$AvgTime),]
for (i in unique(df_rat_pl$PID)){
df_rat_pl$Practice[df_rat_pl$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure"]
}
df_rat_pl$Stage <- relevel(as.factor(df_rat_pl$Stage), ref = "Pre-Exposure")
levels(df_rat_pl$Stage )
aov <- aov(Correct ~ Stage + Error(PID), data = df_rat_pl)
summary(aov)
sjstats::anova_stats(aov, digits = 3)
ggplot(df_rat_pl, aes(x = Stage, y = Correct)) +
stat_summary(geom="point", fun = mean, size = 3.5) +
labs(title = "Differences in Correct RAT Responses By Stage",
subtitle = NULL,
x =NULL,
y ="Number Correct",
caption = "p > 0.05: N.S. \np < 0.05: * \np < 0.01: ** \np < 0.001: ***") +
theme_classic() +
theme(plot.title = element_text(face="bold", size=13, hjust = 0.5)) +
theme(plot.subtitle = element_text(size = 10, hjust = 0.5, face = "italic")) +
theme(plot.caption = element_text(size = 8, hjust = 0.0, face = "italic")) +
theme(axis.title = element_text(size = 12)) +
theme(axis.text.x = element_text(size = 14, color = "Black")) +
theme(axis.text.y = element_text(size = 14, color = "Black"))
aov <- aov(AvgTime ~ Stage + Error(PID), data = df_rat_pl)
summary(aov)
sjstats::anova_stats(aov, digits = 3)
ggplot(df_rat_pl, aes(x = Stage, y = AvgTime)) +
stat_summary(geom="point", fun = mean, size = 3.5) +
labs(title = "Differences in Correct RAT Responses By Stage",
subtitle = NULL,
x =NULL,
y ="Number Correct",
caption = "p > 0.05: N.S. \np < 0.05: * \np < 0.01: ** \np < 0.001: ***") +
theme_classic() +
theme(plot.title = element_text(face="bold", size=13, hjust = 0.5)) +
theme(plot.subtitle = element_text(size = 10, hjust = 0.5, face = "italic")) +
theme(plot.caption = element_text(size = 8, hjust = 0.0, face = "italic")) +
theme(axis.title = element_text(size = 12)) +
theme(axis.text.x = element_text(size = 14, color = "Black")) +
theme(axis.text.y = element_text(size = 14, color = "Black"))
df_test <- as.data.frame(sort(unique(df_rat_pl$PID)))
colnames(df_test) <- "PID"
df_test$diffbefore <- NA
df_test$diffafter <- NA
for (i in unique(df_test$PID)){
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure")){
df_test$diffbefore[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Pre-Exposure"]
}
if (any(df_rat_pl$PID == i & df_rat_pl$Stage == "One Week Post-Exposure")){
df_test$diffafter[df_test$PID == i] <- df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "Immediate Post-Exposure"] - df_rat_pl$Correct[df_rat_pl$PID == i & df_rat_pl$Stage == "One Week Post-Exposure"]
}
}
df_test$congru <- "Mixed"
for (i in 1:nrow(df_test)){
if (df_test$diffbefore[i] > 0 & df_test$diffafter[i] > 0 & !is.na(df_test$diffbefore[i]) & !is.na(df_test$diffafter[i])){
df_test$congru[i] <- "Higher Imm"
}
if (df_test$diffbefore[i] < 0 & df_test$diffafter[i] < 0 & !is.na(df_test$diffbefore[i]) & !is.na(df_test$diffafter[i])){
df_test$congru[i] <- "Lower Imm"
}
}
table(df_test$congru)
test <- as.data.frame(1)
View(test)
install.packages("swirlr")
install.packages("swirl")
install.packages("swirl")
library(swirl)
swirl()
1
library(swirl)
library(swirl)
swirl()
